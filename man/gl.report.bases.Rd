% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gl.report.bases.r
\name{gl.report.bases}
\alias{gl.report.bases}
\title{Reports summary of base pair frequencies}
\usage{
gl.report.bases(
  x,
  plot.display = TRUE,
  plot.theme = theme_dartR(),
  plot.colors = c("#3B9AB2", "#78B7C5"),
  save.type = NULL,
  save.dir = NULL,
  save.file = NULL,
  verbose = NULL,
  ...
)
}
\arguments{
\item{x}{Name of the genlight object containing the SNP or presence/absence
(SilicoDArT) data [required].}

\item{plot.display}{If TRUE, histograms of base composition are displayed in the plot window
[default TRUE].}

\item{plot.theme}{Theme for the plot. See Details for options
[default theme_dartR()].}

\item{plot.colors}{List of two color names for the borders and fill of the
plots [default two_colors=c("#3B9AB2", "#78B7C5")].}

\item{save.type}{If specified, will direct the saved output to a file of this type [default NULL]}

\item{save.dir}{Directory in which to save the ggplot [default = working directory]}

\item{save.file}{Name for the ggsave file [default NULL]}

\item{verbose}{Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
 [default NULL, unless specified using gl.set.verbosity]
 @param ... Parameters passed to function \link[ggplot2]{ggsave}, 
 such as width and height, when the ggplot is to be saved.}
}
\value{
The unchanged genlight object
}
\description{
This script calculates the frequencies of the four DNA nucleotide bases:
adenine (A), cytosine (C), 'guanine (G) and thymine (T), and the frequency of
transitions (Ts) and transversions (Tv) in a DArT genlight object.
}
\details{
The function checks first if trimmed sequences are included in the
locus metadata (@other$loc.metrics$TrimmedSequence), and if so, tallies up
the numbers of A, T, G and C bases. Only the reference state at the SNP locus
is counted. Counts of transitions (Ts) and transversions (Tv) assume that
there is no directionality, that is C->T is the same as T->C, because the
reference state is arbitrary.

For presence/absence data (SilicoDArT), it is not possible to count
transversions or transitions or transversions/transitions ratio because the
 SNP data are not available, only a single sequence tag per locus.
 
 A color vector can be obtained with gl.select.colors() and then passed to the function
 with the plot.colors parameter.

Themes can be obtained from in \itemize{
 \item \url{https://ggplot2.tidyverse.org/reference/ggtheme.html} and \item
 \url{https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/}
 }
 
 If the save.type parameter is set to one of 
"RDS", "eps", "ps", "tex", "pdf", "jpeg", "tiff", "png", 
"bmp", "svg" or "wmf" (windows only), the graphics produced by the function
will be saved to disk. The option "RDS" saves as a binary file 
using saveRDS(); can be reloaded with readRDS().

Optional additional parameters for ggsave() can be added to the parameter list
(...) to govern aspects of the saved plot. Refer to ?ggsave for details.

 If a plot directory (save.dir) is specified, the ggplot binary is saved to that
 directory; otherwise to the working directory. 
 
 A file name must be specified for the plot to be saved.
 
 Note that if save.type is specified as one of "eps", "ps", "tex", "pdf", "jpeg", "tiff", "png", 
"bmp", "svg" or "wmf" , then in addition to saving the plot file, a binary copy
of the ggplot object will be saved as a RDS binary file using saveRDS(). Can be
reloaded with readRDS().
}
\examples{
# SNP data
  out <- gl.report.bases(testset.gl)
  out <- gl.report.bases(testset.gl,save.type="pdf",save.file="myplot")
  
  col <- gl.select.colors(select=c(6,1),palette=rainbow)
  out <- gl.report.bases(testset.gl,plot.colors=col)
  #' # Tag P/A data
  out <- gl.report.bases(testset.gs)

}
\seealso{
Other dartR-base: 
\code{\link{gl.drop.ind}()},
\code{\link{gl.drop.loc}()},
\code{\link{gl.drop.pop}()},
\code{\link{gl.edit.recode.ind}()},
\code{\link{gl.edit.recode.pop}()},
\code{\link{gl.keep.loc}()},
\code{\link{gl.make.recode.ind}()},
\code{\link{gl.read.dart}()},
\code{\link{gl.recode.ind}()},
\code{\link{gl.recode.pop}()},
\code{\link{gl.select.colors}()},
\code{\link{gl.select.shapes}()},
\code{\link{utils.dart2genlight
Converts DarT to genlight.
Internal function called by gl.read.dart()}},
\code{\link{utils.read.dart}()},
\code{\link{utils.recalc.avgpic
A utility function to recalculate the OneRatioRef, OneRatioSnp, PICRef, PICSnp,
 and AvgPIC by locus after some individuals or populations have been deleted.

The locus metadata supplied by DArT has OneRatioRef, OneRatioSnp, PICRef,
 PICSnp, and AvgPIC included, but the allelic composition will change when
 some individuals,or populations, are removed from the dataset and so the
 initial statistics will no longer apply. This script recalculates these
 statistics and places the recalculated values in the appropriate place in
 the genlight object.

If the locus metadata OneRatioRef|Snp, PICRef|Snp and/or AvgPIC do not exist,
 the script creates and populates them.}},
\code{\link{utils.recalc.callrate
A utility script to recalculate the callrate by locus after some populations
have been deleted

SNP datasets generated by DArT have missing values primarily arising from
failure to call a SNP because of a mutation at one or both of the
restriction enzyme recognition sites. The locus metadata supplied by DArT has
 callrate included, but the call rate will change when some individuals are
 removed from the dataset. This script recalculates the callrate and places
 these recalculated values in the appropriate place in the genlight object.
 It sets the Call Rate flag to TRUE.}},
\code{\link{utils.recalc.freqhets
A utility script to recalculate the frequency of the heterozygous SNPs by
locus after some populations have been deleted

The locus metadata supplied by DArT has FreqHets included, but the frequency
 of the heterozygotes will change when some individuals are removed from the
 dataset.

This script recalculates the FreqHets and places these recalculated values in
 the appropriate place in the genlight object.

Note that the frequency of the homozygote reference SNPS is calculated from
the individuals that could be scored.}},
\code{\link{utils.recalc.freqhomsnp
A utility function to recalculate the frequency of the homozygous alternate
SNP by locus after some populations have been deleted

The locus metadata supplied by DArT has FreqHomSnp included, but the
frequency of the homozygous alternate will change when some individuals are
removed from the dataset.

This function recalculates the FreqHomSnp and places these recalculated values
 in the appropriate place in the genlight object.

Note that the frequency of the homozygote alternate SNPS is calculated from
the individuals that could be scored.

This function only applies to SNP genotype data not Tag P/A data (SilicoDArT).}},
\code{\link{utils.recalc.maf
A utility script to recalculate the minor allele frequency by locus,
typically after some populations have been deleted

The locus metadata supplied by DArT does not have MAF included, so it is
calculated and added to the locus.metadata by this script. The minimum allele
frequency will change when some individuals are removed from the dataset.
This script recalculates the MAF and places these recalculated values in the
 appropriate place in the genlight object.
 
 This function only applies to SNP genotype data.}},
\code{\link{utils.reset.flags
A utility function to reset to FALSE (or TRUE) the locus metric flags after
some individuals or populations have been deleted.

The locus metadata supplied by DArT has OneRatioRef, OneRatioSnp, PICRef,
PICSnp, and AvgPIC included, but the allelic composition will change when
some individuals are removed from the dataset and so the initial statistics
will no longer apply. This applies also to some variable calculated by dartR
(e.g. maf). This script resets the locus metrics flags to FALSE to indicate
that these statistics in the genlight object are no longer current. The
verbosity default is also set, and in the case of SilcoDArT, the flags PIC
and OneRatio are also set.

If the locus metrics do not exist then they are added to the genlight object
 but not populated. If the locus metrics flags do not exist, then they are
 added to the genlight object and set to FALSE (or TRUE).}},
\code{\link{utils.transpose}()}
}
\author{
Custodian: Arthur Georges -- Post to
\url{https://groups.google.com/d/forum/dartr}
}
\concept{dartR-base}
